---
title: "DuomenÅ³ tinkamumo patvirtinimo / redagavimo / Ä¯raÅ¡ymo Å¾iniÅ³ vidiniai mokymai (II)"
author: "Lietuvos Statistika"
output: 
   learnr::tutorial:
       theme: "cerulean"
       language: 
        en:
         button:
           nexttopic: Pirmyn
           previoustopic: Atgal
           runcode: Vykdyti kodÄ…
           hint: UÅ¾uomina
           hint_plural: UÅ¾uominos
           hintnext: Kita uÅ¾uomina
           hintprev: Atgal
           solution: Sprendimas
           copyclipboard: Kopijuoti
           startover: IÅ¡ naujo
           continue: TÄ™sti
           submitanswer: Pateikti atsakymÄ…
           questiontryagain: Bandyti iÅ¡ naujo
         text:
           startover: Perkrauti
           areyousure: Esate tikri, kad norite perkrauti esamÄ… programÄ…?
           youmustcomplete: Turite pabaigti 
           exercise: uÅ¾duotis
           exercise_plural: uÅ¾duotys
           inthissection: Å¡ioje dalyje norÄ—dami tÄ™sti. 
           code: Kodas
           quiz: Klausimas
progressive: true
allow_skip: true
runtime: shiny_prerendered
---


```{r setup, include=FALSE}


r = getOption("repos")
r["CRAN"] = "http://cran.us.r-project.org"
options(repos = r)


install.packages("rmarkdown")
install.packages("sortable")
install.packages("openxlsx")
install.packages("scales")
install.packages("readxl")
install.packages("tidyverse")
install.packages("remotes")
remotes::install_github("rstudio/gradethis")
remotes::install_github("rstudio/learnr")

library(learnr)
library(gradethis)
library(rmarkdown)
library(sortable)
library(openxlsx)
library(scales)
library(readxl)
library(tidyverse) 
knitr::opts_chunk$set(echo = FALSE)
tutorial_options(
  exercise.checker = gradethis::grade_learnr, 
  exercise.startover = TRUE
)
options(scipen=999)
setwd("~/SwedenStuff/Lietuvos Statistika/LS - 2 skaidres")
# Create objects use throughout tutorial:
# Read in data as `duomenys`
duomenys <- read_excel("Duomenys.xlsx")
names(duomenys) <- c("kodas9", "evrk2", "imtis", "viso", "val", "viso_prm_ket", "viso_pr_ket", "pvm", "DSK")

```

## Ä®Å¾anga

```{r, echo=FALSE, out.width="50%", fig.align = "center"}
knitr::include_graphics("images/introtoR.png")  
```
```{r, echo=FALSE, out.width="10%", fig.align = "center"}
knitr::include_graphics("images/LS_logo.svg")  
```

<br>
Å ioje platformoje rasite mokymÅ³ medÅ¾iagÄ… Lietuvos Statistikos departamento viduje organizuojamiems mokymams, skirtiems tikslinÄ—ms darbuotojÅ³ grupÄ—ms. Vienas pagrindiniÅ³ Å¡iÅ³ mokymÅ³ siekiÅ³ â€“ platinti Lietuvos Statistikos darbuotojÅ³ Å¾inias ir gebÄ—jimus atlikti statistiniÅ³ duomenÅ³ tinkamumo patvirtinimÄ…, redagavimÄ…, praleistÅ³ reikÅ¡miÅ³ Ä¯raÅ¡ymÄ… naudojantis R programavimo kalba. <br><br> TeorinÄ— mokymÅ³ medÅ¾iaga jau yra parengta skaidriÅ³ pavidalu. Å ioje platformoje turite galimybÄ™ mokytis savarankiÅ¡kai â€“ perÅ¾iÅ«rÄ—ti parengtÄ… mokymÅ³ medÅ¾iagÄ…, atlikti praktines uÅ¾duotis.
<br><br> Antrojoje mokymÅ³ dalyje pateikiama naudinga informacija apie:

- **Kintamuosius**: ir jÅ³ tipus pagal reiÅ¡kinio kilmÄ™ ir matavimÅ³ skalÄ™.
- **Statistines hipotezes**: (ne)atmetimo klaidas, taisykles ir statistinÄ¯ reikÅ¡mingumÄ….
- **Skirstinius**: ir kaip juos vizualiai pateikti R programavimo kalba.
- **DuomenÅ³ tikrinimÄ…**: ir tikrinimo taisykles.
- **IÅ¡siskirianÄias reikÅ¡mes**: normaliojo skirstinio grafike ir kaip jas apdoroti.
- **RÄ—Å¾iÅ³ taisyklÄ™**: ir kaip jÄ… apskaiÄiuoti naudojantis R.
- **IstorinÄ™ (palyginimo) taisyklÄ™**: bei kam jÄ… taikyti.
 <br><br>

#### Kaip tai veikia?

Rasite klausimÅ³ su atsakymÅ³ variantais:
```{r quiz0, fill = "orange", warning=FALSE, echo=FALSE}
quiz(caption = "",
  question("Kiek bus 5+5?", 
           answer("15"),
           answer("10", correct = TRUE), 
           answer("11"),
           answer("100"),
           correct = "Atsakymas teisingas!", 
           incorrect = "Atsakymas neteisingas",
  submit_button = "Pateikti", 
  try_again_button = "IÅ¡ naujo",
    allow_retry = TRUE
  )
)
```

Rasite klausimÅ³, kuriuose reikalinga iÅ¡rikiuoti atsakymus pagal tam tikrÄ… eilÄ™:

```{r ranking-example, warning=FALSE, echo=FALSE}

question_rank("<br>1. 2+2 <br>
              2. 10+10 <br>
              3. 100-90 <br>
              4. 4*2",
  answer(skales <- c(
    "4",
    "20",
    "10",
    "8"),
  correct = TRUE), correct = "Teisingai!", incorrect = "Bandykite dar kartÄ…!",
  allow_retry = TRUE,
  random_answer_order = TRUE,
  submit_button = "Pateikti",
  options = sortable_options(), 
  try_again_button = "IÅ¡ naujo"
)
```

Taip pat, dirbsite su R, kur programavimo kodas veiks lyg dirbant tiesiogiai programoje. Paspauskite `Ctr+Enter` arba `Vykdyti kodÄ…` mygtukÄ…, kad Ä¯vykdytumÄ—te programÄ…. 

```{r, echo=FALSE, out.width="85%", fig.align = "center"}
knitr::include_graphics("images/code_chunk_key.png")  
```

```{r example1, exercise=TRUE, exercise.lines = 4, exercise.cap = "R kodas"}
2+2
```

Jeigu nerandate tinkamo atsakymo kodo langelyje, galite pasinaudoti `UÅ¾uomina` , arba pasitikrinti atsakymÄ… `Atsakymas` mygtuku. <br><br> NepamirÅ¡kite pateikti atsakymo paspausdami `Pateikti atsakymÄ…` mygtukÄ…, kur gausite iÅ¡samesnÄ¯ komentarÄ… apie savo kodÄ… anglÅ³ kalba. 

```{r, echo=FALSE, out.width="85%", fig.align = "center"}
knitr::include_graphics("images/code_exercise_key.png")  
```

```{r example2, exercise=TRUE, exercise.lines = 3, exercise.cap = "R kodas"}
2+2==5
```

```{r example2-hint}
Ar suma teisinga?
```

```{r example2-solution}
2+2==4
```

```{r example2-check}
gradethis::grade_code()
```

Taip pat, prieÅ¡ pradedant mokymus, svarbu nuspausti mygtukÄ… `Perkrauti` (kaip paÅ¾ymÄ—ta paveikslÄ—lyje). Tai uÅ¾tikrina, kad uÅ¾duotys yra vykdomos nuo pradÅ¾iÅ³. Å Ä¯ mygtukÄ… galite naudoti kaskart, kai norite perkrauti mokymÅ³ medÅ¾iagÄ… ir jÄ… Ä¯vykdyti iÅ¡ naujo.

```{r, echo=FALSE, out.width="100%", fig.align = "center"}
knitr::include_graphics("images/start_over.png")  
```

#### Iliustracijos
Å i mokymÅ³ platforma iliustruota paveikslÄ—liais, kuriuos galite rasti [Å¡iuo adresu](https://github.com/allisonhorst/stats-illustrations/). Naudojant Å¡ias iliustracijas, cituokite jas taip: â€œArtwork by @allison_horstâ€.

**SÄ—kmÄ—s!**

## 1. Kintamieji

```{r, echo=FALSE, out.width="80%", fig.align = "center"}
knitr::include_graphics("images/types.jfif")  
```

#### 1.1. Kokiam kintamÅ³jÅ³ tipui priskiriami duomenys gauti Å¾emiau nurodytame apraÅ¡yme?

```{r quiz1, fill = "orange", warning=FALSE, echo=FALSE}
quiz(caption = "",
  question("Tyrime apie muzikos poveikÄ¯ Å¾monÄ—ms, kenÄiantiems nuo lÄ—tinio skausmo, visi rezultatai gauti naudojant klausimynus, vertinanÄius skausmÄ… skalÄ—je nuo 1 iki 10.", 
           answer("Kokybiams (kategoriniams)"),
           answer("Kiekybiniams", correct = TRUE), 
           correct = "Atsakymas teisingas! Kiekybiniai kintamieji parodo, kiek tiriamo poÅ¾ymio turi populiacijos elementas, pvz. pajamos, amÅ¾ius, Ä¯monÄ—s darbuotojÅ³ skaiÄius ir pan.", 
           incorrect = "Atsakymas neteisingas. Å ie kintamieji nusako dydÅ¾ius, kuriÅ³ neÄ¯manoma Ä¯vertinti skaiÄiais, pvz., lytis, iÅ¡silavinimas, ekonominÄ—s veiklos rÅ«Å¡is ir pan.
",
  submit_button = "Pateikti", 
  try_again_button = "IÅ¡ naujo",
    allow_retry = TRUE
  ),
  question("Norime parduoti produktÄ… ir esame suinteresuoti Å¾inoti Å¡eimyninÄ™ padÄ—tÄ¯. NorÄ—dami tai padaryti, priskiriame 1 - vieniÅ¡ui, 2 - vedusiam, 3 - iÅ¡siskyrusiam, 4 - partneriui ir 5 - kitiems tyrimo dalyviams.", 
           answer("Kokybiams (kategoriniams)", correct = TRUE),
           answer("Kiekybiniams"), 
           correct = "Atsakymas teisingas! Kokybiniai (arba kategoriniai) kintamieji nusako dydÅ¾ius, kuriÅ³ neÄ¯manoma Ä¯vertinti skaiÄiais, pvz. lytis, iÅ¡silavinimas, ekonominÄ—s veiklos rÅ«Å¡is ir pan. Kokybinio kintamojo reikÅ¡mes koduojant skaitmenimis, kintamojo prasmÄ— nesikeiÄia.", 
           incorrect = "Atsakymas neteisingas. Kiekybiniai kintamieji parodo, kiek tiriamo poÅ¾ymio turi populiacijos elementas, pvz. pajamos, amÅ¾ius, Ä¯monÄ—s darbuotojÅ³ skaiÄius ir pan.",
  allow_retry = TRUE,
  submit_button = "Pateikti", 
  try_again_button = "IÅ¡ naujo"
  )
)
```

```{r, echo=FALSE, out.width="80%", fig.align = "center"}
knitr::include_graphics("images/types2.png")  
```

#### 1.2. Kuriam kiekybinio kintamojo tipui priklauso Å¡ie duomenÅ³ pavyzdÅ¾iai:
```{r quiz2, warning=FALSE, echo=FALSE}
quiz(caption = "",
   question("DuomenÅ³ Ä¯vedimo klaidÅ³ skaiÄius Lietuvos Statistikos Departamente; nelaimingÅ³ atsitikimÅ³ skaiÄius Vilniuje?", 
           answer("Tolydiesiems"),
           answer("Diskretiesiems", correct = TRUE), 
           correct = "Atsakymas teisingas! Kiekybinis kintamasis, kurio reikÅ¡miÅ³ skirtumas yra ne maÅ¾esnis uÅ¾ tam tikrÄ… minimalÅ³ pokytÄ¯, vadinamas diskreÄiuoju kintamuoju (pvz., Ä¯monÄ—s darbuotojÅ³ skaiÄius).", 
           incorrect = "Neteisingas atsakymas. Tolydieji kintamieji Ä¯gyja reikÅ¡mes neskaiÄioje skalÄ—je
ir jÅ³ Ä¯gyjamÅ³ reikÅ¡miÅ³ sunumeruoti negalima.
",
    allow_retry = TRUE,
  submit_button = "Pateikti", 
  try_again_button = "IÅ¡ naujo"
  )
)
```

#### 1.3. KintamÅ³jÅ³ tipai pagal matavimo skalÄ™

Kintamuosius galima klasifikuoti pagal naudojamÄ… matavimÅ³ skalÄ—s tipÄ…:

- **PavadinimÅ³ (arba nominalioji, klasifikavimo) skalÄ—**: pagal kintamojo reikÅ¡mes, gautas naudojant pavadinimÅ³ skalÄ™, tyrimo objektus galima tik klasifikuoti, t. y. priskirti vienai ar kitai klasei. Objektams arba objektÅ³ klasÄ—ms priskiriami simboliai (kategorijÅ³ kodai). Jie tarpusavyje nepalyginami (net tuo atveju, kai yra skaiÄiai).  
- **RangÅ³ (arba tvarkos, eilÄ—s) skalÄ—**: Å¡i skalÄ— naudojama tada, kai galima nustatyti objektÅ³ tiriamo poÅ¾ymio skirtumus ir pagal tai objektus iÅ¡rikiuoti Ä¯ eilÄ™. Pagal ranginiÅ³ kintamÅ³jÅ³ reikÅ¡mes objektus galima ne tik skirstyti Ä¯ klases, bet ir jas sutvarkyti. Ar didesnis rangas (sutvarkytos eilÄ—s numeris) atitinka didesnÄ¯ poÅ¾ymio kiekÄ¯ ar svarbÄ…, priklauso nuo rangÅ³ priskyrimo taisyklÄ—s. Rangai tarpusavyje gali bÅ«ti lyginami tik eiliÅ¡kumui nustatyti
- **IntervalÅ³ skalÄ—**: matavimams naudojant intervalÅ³ skalÄ™, objektus galima ne tik klasifikuoti, tvarkyti, bet ir kiekybiÅ¡kai Ä¯vertinti skirtumus. Intervaliniai duomenys visada skaitiniai. Skirtumas (intervalas) tarp dviejÅ³ kintamojo reikÅ¡miÅ³ rodo, kiek daugiau ar maÅ¾iau matuojamo poÅ¾ymio yra viename tyrimo objekte, palyginti su kitu. Nulinis taÅ¡kas intervalÅ³ skalÄ—je yra laisvai pasirenkamas. 
- **SantykiÅ³ skalÄ—**: nuo intervalÅ³ skalÄ—s skiriasi tik tuo, kad joje yra apibrÄ—Å¾ta absoliuti atskaitos pradÅ¾ia. Å ioje skalÄ—je yra absoliutusis nulis, t.y. nulinis taÅ¡kas, rodantis, kad tiriamojo poÅ¾ymio nÄ—ra. Taigi rezultatai visuomet yra neneigiami skaiÄiai. 

```{r, echo=FALSE, out.width="75%", fig.align = "center"}
knitr::include_graphics("images/skales.png")  
```

```{r ranking, warning=FALSE, echo=FALSE}

question_rank("PerÅ¾velkite aukÅ¡Äiau esantÄ¯ paveikslÄ—lÄ¯ ir surikiuokite kintamÅ³jÅ³ tipus Ä¯ atitinkamÄ… eilÄ™ nuo 1 iki 4:",
  answer(skales <- c(
    "PavaidinimÅ³ (nominalioji)",
    "RanginÄ—",
    "IntervalinÄ—",
    "SantykÅ³"),
  correct = TRUE), correct = "Teisingai! <br><br> Pagal kintamojo reikÅ¡mes, gautas naudojant **pavadinimÅ³ skalÄ™**, tyrimo objektus galima tik klasifikuoti, t. y. priskirti vienai ar kitai klasei. <br> Kintamieji, matuojami rangÅ³ skalÄ—je, vadinami **ranginiais kintamaisiais** ir tarpusavyje gali bÅ«ti lyginami tik eiliÅ¡kumui nustatyti., pvz. iÅ¡silavinimo lygis. <br> Matavimams naudojant **intervalÅ³ skalÄ™**, objektus galima ne tik klasifikuoti, tvarkyti, bet ir kiekybiÅ¡kai Ä¯vertinti skirtumus. <br> Na, o **santykiÅ³ skalÄ—** nuo intervalÅ³ skalÄ—s skiriasi tik tuo, kad joje yra apibrÄ—Å¾ta absoliuti atskaitos pradÅ¾ia. Å ioje skalÄ—je yra absoliutusis nulis, t. y. nulinis taÅ¡kas, rodantis, kad tiriamojo poÅ¾ymio nÄ—ra.", 
  incorrect = "Bandykite dar kartÄ…! <br> Pagal kintamojo reikÅ¡mes, gautas naudojant **pavadinimÅ³ skalÄ™**, tyrimo objektus galima tik klasifikuoti, t. y. priskirti vienai ar kitai klasei. <br> Kintamieji, matuojami rangÅ³ skalÄ—je, vadinami **ranginiais kintamaisiais** ir tarpusavyje gali bÅ«ti lyginami tik eiliÅ¡kumui nustatyti., pvz. iÅ¡silavinimo lygis. <br> Matavimams naudojant **intervalÅ³ skalÄ™**, objektus galima ne tik klasifikuoti, tvarkyti, bet ir kiekybiÅ¡kai Ä¯vertinti skirtumus. <br> Na, o **santykiÅ³ skalÄ—** nuo intervalÅ³ skalÄ—s skiriasi tik tuo, kad joje yra apibrÄ—Å¾ta absoliuti atskaitos pradÅ¾ia. Å ioje skalÄ—je yra absoliutusis nulis, t. y. nulinis taÅ¡kas, rodantis, kad tiriamojo poÅ¾ymio nÄ—ra.",
  allow_retry = TRUE,
  random_answer_order = TRUE,
  submit_button = "Pateikti", 
  try_again_button = "IÅ¡ naujo",
  options = sortable_options()
)
```

## 2. StatistinÄ—s hipotezÄ—s

Statistine hipoteze vadinamas bet koks teiginys apie tiriamosios populiacijos skirstinÄ¯, jo parametro(-Å³) reikÅ¡mÄ™(-es) arba tiriamosios populiacijos skirstinio ar jo parametrÅ³ lygybÄ™ kitiems skirstiniams ar parametrams. <br><br> StatistinÄ™ hipotezÄ™ sudaro du alternatyvÅ«s teiginiai apie galimÄ… skirstinÄ¯ ar galimas parametro reikÅ¡mes: $H_0$ â€“ nulinÄ— hipotezÄ— ir $H_1$ â€“ alternatyvioji hipotezÄ— (alternatyva). <br><br> Atmesdami ar neatmesdami hipotezÄ—s $H_0$, galime padaryti dviejÅ³ rÅ«Å¡iÅ³ klaidas (Å¾emiau paÅ¾ymÄ—tas geltona bei mÄ—lyna spalvomis):


```{r, echo=FALSE, out.width="75%", fig.align = "center"}
knitr::include_graphics("images/hipoteziu_klaidos.png")  
```

#### 2.1. (Ne)atmetimo klaidos: kuri klaida ($I$ ar $II$) paveikslÄ—lyje pavaizduota geltona spalva?

```{r quiz3, warning=FALSE, echo=FALSE}
quiz(caption = "",
  question("", 
           answer("$I$ rÅ«Å¡ies - $H_0$ atmetame, kai ji teisinga."),
           answer("$II$ rÅ«Å¡ies - $H_0$ neatmetame, kai ji klaidinga.", correct = TRUE), 
           correct = "Atsakymas teisingas! <br><br>TaisyklÄ—, pagal kuriÄ… iÅ¡ imties rezultatÅ³ darome iÅ¡vadÄ… apie hipotezÄ—s teisingumÄ… ar klaidingumÄ…, vadinama statistiniu kriterijumi. Kriterijus tuo geresnis, kuo maÅ¾esnÄ—s abiejÅ³ rÅ«Å¡iÅ³ klaidÅ³ tikimybÄ—s. PraktiÅ¡kai neÄ¯manoma sudaryti kriterijaus, kad abiejÅ³ klaidÅ³ tikimybÄ—s bÅ«tÅ³ lygios 0. DaÅ¾niausiai parenkamas maÅ¾as teigiamas skaiÄius $Î±$ ir nagrinÄ—jami tokie kriterijai, kuriÅ³ pirmosios rÅ«Å¡ies klaidos tikimybÄ— nevirÅ¡ija $Î±$. SkaiÄius $Î±$ vadinamas kriterijaus reikÅ¡mingumo lygmeniu. DaÅ¾niausiai imama $Î±=0.05$ (reÄiau $Î±=0.01$ ar $Î±=0.1$).", 
           incorrect = "Bandykite dar kartÄ…. <br> <br> I rÅ«Å¡ies klaida - klaidingai atrasti tai, ko nÄ—ra, pavyzdÅ¾iui, diagnozÄ— â€nÄ—Å¡Äias vyrasâ€œ (klaidingai nustatytas nÄ—Å¡tumas) ir teigti, kad skirtumas yra, kai iÅ¡ tiesÅ³ jo nÄ—ra (t.y. kai nulinÄ— hipotezÄ— yra teisinga). Pirmos rÅ«Å¡ies klaidos tikimybÄ™ Å¾ymime Î±.",
           allow_retry = TRUE,
  submit_button = "Pateikti", 
  try_again_button = "IÅ¡ naujo"
  )
)
```

#### 2.2. (Ne)atmetimo taisyklÄ—: koks $p$ reikÅ¡mingumo lygmuo?

```{r blank1, exercise.blanks = TRUE, warning=FALSE, echo=FALSE}
quiz(caption = "",
  question("Suformuluojama pagrindinÄ— hipotezÄ— $H_0$ ir alternatyvioji $H_1$. DaÅ¾niausiu atveju, esant kokiai maÅ¾iausiai $p$ reikÅ¡mei tariama, kad nÄ—ra pagrindo atmesti hipotezÄ™ $H_0$?", 
           answer("0.95"),
           answer("0.05", correct = TRUE), 
           answer("0.005"),
           answer("0.01"),
           correct = "Atsakymas teisingas!", 
           incorrect = "Bandykite dar kartÄ….",
           allow_retry = TRUE,
  submit_button = "Pateikti", 
  try_again_button = "IÅ¡ naujo"
  )
)
```
P.S. Å i reikÅ¡mÄ— yra daÅ¾niausiai naudojama, bet pasitaiko ir atvejÅ³, kuomet pasirenkama kitas, labiau tinkantis reikÅ¡mingumo lygmuo.<br>

#### 2.3. Atlikite `t.test` duoto kintamojo vidurkio lygybei nuliui ($H_0$) patikrinti.

```{r t-test, exercise=TRUE, exercise.lines = 2, exercise.cap = "R kodas"}
x = c(9.0,9.5,9.6,10.2,11.6)
```

```{r t-test-hint}
Jeigu nesate tikri, kaip naudoti t.test() funkcijÄ… - Ä¯raÅ¡ykite ?t.test() R kodo laukelyje. 
```


```{r t-test-solution}
x = c(9.0,9.5,9.6,10.2,11.6)
t.test(x)
```
```{r t-test-check}
gradethis::grade_code()

```

```{r quiz4, warning=FALSE, echo=FALSE}
quiz(caption = "",
  question("Ar alternatyvioji hipotezÄ— patvirtinta?", 
           answer("Taip, $p$ reikÅ¡mÄ— lygi 0.01"),
           answer("Taip, $p$ reikÅ¡mÄ— Å¾emesnÄ— nei 0.05", correct = TRUE),
           answer("Ne, $p$ reikÅ¡mÄ— didesnÄ— nei 0.05"),
           answer("Ne, $t$ reikÅ¡mÄ— lygi 22.294"),
           correct = "Atsakymas teisingas!", 
           incorrect = "Bandykite dar kartÄ…. <br> ReikÅ¡mingumo lygmuo daÅ¾niausiai imamas $Î±=0,05$ (reÄiau $Î±=0,01$ ar $Î±=0,1$).",
           allow_retry = TRUE,
  submit_button = "Pateikti", 
  try_again_button = "IÅ¡ naujo"
  )
)
```
```{r, echo=FALSE, out.width="70%", fig.align = "center"}
knitr::include_graphics("images/errors.png")  
```

## 3. Skirstiniai

```{r, echo=FALSE, out.width="70%", fig.align = "center"}
knitr::include_graphics("images/normal_distribution.png")  
```

#### 3.1. UÅ¾pildykite tuÅ¡Äias vietas ir sugeneruokite dvi atsitiktines 2000 stebiniÅ³ imtis.

```{r atsitiktinis-skirstinys, exercise=TRUE, exercise.lines = 4, exercise.cap = "R kodas", warning=FALSE, echo=FALSE}
set.seed(666)
normal_data <- rnorm(____)
log_normal_data <- rlnorm(____)
```
```{r atsitiktinis-skirstinys-hint}
Vietoje tuÅ¡ÄiÅ³ vietÅ³ Ä¯veskite skaiÄiÅ³ 2000.
```

```{r atsitiktinis-skirstinys-solution}
set.seed(666)
normal_data <- rnorm(2000)
log_normal_data <- rlnorm(2000)
```
```{r atsitiktinis-skirstinys-check}
gradethis::grade_code()
```

#### 3.2. Vizualiai patikrinkite 3.1. sugeneruotÅ³ skirstiniÅ³ pasiskirstymo normalumÄ… histogramos funkcija `hist()`. Taip pat, Ä¯veskite abiejÅ³ skirstiniÅ³ `normal_data` ir `log_normal_data` pavadinimus Ä¯ paliktas tuÅ¡Äias vietas.  


```{r atsitiktinis-skirstinys-2, exercise = TRUE, exercise.lines = 3 , exercise.cap = "R kodas", warning=FALSE, echo=FALSE, exercise.setup = "atsitiktinis-skirstinys-solution"}
___(____, col='steelblue', main='Log-Normalusis skirstinys', xlab = "ReikÅ¡miÅ³ pasiskirstymas", ylab = "DaÅ¾nis")
___(____, col='steelblue', main='Log-Normalusis skirstinys', xlab = "ReikÅ¡miÅ³ pasiskirstymas", ylab = "DaÅ¾nis")
```

```{r atsitiktinis-skirstinys-2-solution}
hist(normal_data, col='steelblue', main='Log-Normalusis skirstinys', xlab = "ReikÅ¡miÅ³ pasiskirstymas", ylab = "DaÅ¾nis")
hist(log_normal_data, col='steelblue', main='Log-Normalusis skirstinys', xlab = "ReikÅ¡miÅ³ pasiskirstymas", ylab = "DaÅ¾nis")
```

```{r atsitiktinis-skirstinys-2-check}
gradethis::grade_code()
```


#### 3.3. Patikrinkite, ar skirstiniai yra normalieji su *Kolmogorov-Smirnov* testu. Ä®veskite imÄiÅ³ pavadinimus Ä¯ tuÅ¡Äias vietas.

```{r atsitiktinis-skirstinys-3, exercise=TRUE, exercise.lines = 2, exercise.cap = "R kodas", warning=FALSE, echo=FALSE, exercise.setup = "atsitiktinis-skirstinys-solution"}
ks.test(___, "pnorm")
ks.test(___, "pnorm")
```
```{r atsitiktinis-skirstinys-3-solution}
ks.test(normal_data, "pnorm")
ks.test(log_normal_data, "pnorm")
```
```{r atsitiktinis-skirstinys-3-check}
gradethis::grade_code()

```

*Kolmogorov-Smirnov* testo p-reikÅ¡mÄ— - maÅ¾esnÄ— nei 0,05. Vadinasi, galime teigti, kad skirstinys nÄ—ra normaliai pasiskirstÄ™s. AtvirkÅ¡Äiai skirstiniui pavadinimu `normal_data`. <br><br>

#### 3.4. Logoritmuokite log-normalÅ³jÄ¯ skirstinÄ¯ (*1 kodo eilutÄ—*), grafiniu bÅ«du patikrinkite jÄ¯ vizualiai (*2 kodo eilutÄ—*) ir atlikite *Kolmogorov-Smirnov* testÄ… (*3 kodo eilutÄ—*).

```{r atsitiktinis-skirstinys-log, exercise=TRUE, exercise.lines = 4, exercise.cap = "R kodas", warning=FALSE, echo=FALSE, exercise.setup = "atsitiktinis-skirstinys-solution"}
log_normal_data_log <- ___(log_normal_data)
___(log_normal_data_log, col='steelblue', main='Log log-normalusis skirstinys', xlab = "ReikÅ¡miÅ³ pasiskirstymas", ylab = "DaÅ¾nis")
___(log_normal_data_log, "pnorm")
```

```{r atsitiktinis-skirstinys-log-hint}
Naudokite log() hist() ir ks.test() funkcijomis atititnkamiems Å¾ingsniams Ä¯vykdyti. 
```

```{r atsitiktinis-skirstinys-log-solution}
log_normal_data_log <- log(log_normal_data)
hist(log_normal_data_log, col='steelblue', main='Log log-normalusis skirstinys', xlab = "ReikÅ¡miÅ³ pasiskirstymas", ylab = "DaÅ¾nis")
ks.test(log_normal_data_log, "pnorm")
```
```{r atsitiktinis-skirstinys-log-check}
gradethis::grade_code()

```

```{r log-normal, warning=FALSE, echo=FALSE}
quiz(caption = "",
  question("Kokia logoritmuoto log-normaliojo skirstinio `p` reiÅ¡mÄ—?", 
           answer("5.2e-15"),
           answer("0.8866"),
           answer("2.2e-16"),
           answer("0.1444", correct = TRUE),
           correct = "Atsakymas teisingas!", 
           incorrect = "Bandykite dar kartÄ…. <br> Patikrinkite, ar teisingai Ä¯vykdÄ—te visus `3.4.` veiksmus.",
           allow_retry = TRUE,
  submit_button = "Pateikti", 
  try_again_button = "IÅ¡ naujo"
  )
)
```


```{r, echo=FALSE, out.width="15%", fig.align = "left"}
knitr::include_graphics("images/exploder.gif", error = FALSE)  
```


Ä® sistemÄ… jau importuota duomenÅ³ lentelÄ— pavadinimu `duomenys`.<br>

**Kintamieji:**

- `kodas9`: Ä¯monÄ—s kodas
- `evrk2`: Ä¯monÄ—s ekonominÄ—s veiklos rÅ«Å¡ies kodas
- `imtis`: patekimo Ä¯ imtÄ¯ indikatorius
- `viso`: bendra ataskaitinio laikotarpio Ä¯monÄ—s apyvarta
- `val`:  visos ataskaitinÄ¯ laikotarpÄ¯ dirbtos Ä¯monÄ—s darbuotojÅ³ valandos
- `viso_prm_ket`: bendra praeitÅ³ metÅ³ atitinkamo laikotarpio Ä¯monÄ—s apyvarta
- `viso_pr_ket`: bendra praeito laikotarpio Ä¯monÄ—s apyvarta
- `pvm`: Ä¯monÄ—s apyvarta pagal PVM ataskaitÅ³ duomenis
- `DSK`: vidutinis ataskaitinio laikotarpio Ä¯monÄ—s darbuotojÅ³ skaiÄius


#### 3.5. Modifikuokite Å¾emiau esantÄ¯ R kodÄ…, kad matytumÄ—te tik pirmÄ…sias 6 eilutes.

```{r print-limit, exercise=TRUE, exercise.lines = 2, exercise.cap = "R kodas", warning=FALSE, echo=FALSE}
duomenys
```

```{r print-limit-solution}
head(duomenys)
```

```{r print-limit-check}
gradethis::grade_code()

```

#### 3.6. PaÅ¡alinkite tuÅ¡Äias reikÅ¡mes iÅ¡ stulpeliÅ³ pavadinimu `viso` bei `pvm`  (realioje situacijoje tokias reikÅ¡mes reikÄ—tÅ³ atskirti Ä¯ kitÄ… lentelÄ™ ir perÅ¾iÅ«rÄ—ti). 

```{r remove-NAs, exercise=TRUE, exercise.cap = "R kodas", warning=FALSE, echo=FALSE}
duomenys1 <- ___ %>%
  filter_at(vars(___, ___), all_vars(!is.na(.)))
  
View(duomenys1)
```

```{r remove-NAs-hint}
Ä®veskite duomenÅ³ rinkinio bei kintamÅ³jÅ³ pavadinimus. 
```

```{r remove-NAs-solution}
duomenys1 <- duomenys %>%
  filter_at(vars(viso, pvm), all_vars(!is.na(.)))
  
View(duomenys1)
```

```{r remove-NAs-check}
gradethis::grade_code()

```


#### 3.7. PridÄ—kite prie Å¾emiau esanÄio R kodo aiÅ¡kesnius pavadinimus vizualizacijai, pvz. `xlab = "PVM apyvarta"` bei `ylab = "Statistinio tyrimo apyvarta"`. 

```{r vizualizacija-setup}
duomenys1 <- duomenys %>%
  filter_at(vars(viso, pvm), all_vars(!is.na(.)))
```


```{r vizualizacija, exercise=TRUE, exercise.cap = "R kodas", warning=FALSE, echo=FALSE}
plot(duomenys1[,c("pvm","viso")], col= 'steelblue', main='Tarpusavio priklausomybÄ—s grafikas')
```

```{r vizualizacija-hint}
NepamirÅ¡kite, prieÅ¡ raÅ¡ant x ir y aÅ¡iÅ³ pavadinimus, po ] skliaustelio padÄ—ti kablelÄ¯ (,).
```

```{r vizualizacija-solution}
plot(duomenys1[,c("pvm","viso")], col= 'steelblue', main= 'Log log-normalusis skirstinys', xlab = "PVM apyvarta", ylab = "Statistinio tyrimo apyvarta" )
     
```

```{r vizualizacija-check}
gradethis::grade_code()

```

## 4. DuomenÅ³ tikrinimas

```{r, echo=FALSE, out.width="70%", fig.align = "center"}
knitr::include_graphics("images/tidy.jpg")  
```

#### 4.1. Surikiuokite pagal pateiktÅ³ apibrÄ—Å¾imÅ³ eilÄ™:
```{r ranking2, warning=FALSE, echo=FALSE}
question_rank("<br> 1. Tikrinama ar Ä¯vestas ekonominÄ—s veiklos kodas egzistuoja, tinkamai koduota lytis, Ä¯vesta ne per daug / ne per maÅ¾ai simboliÅ³.<br>
              2. Jei uÅ¾pildytas darbuotojÅ³ skaiÄius, tikrinama ar uÅ¾pildytos ir jÅ³ dirbtos valandos.<br>
              3. Tikrinama ar dvideÅ¡imties metÅ³ jaunuolis nepaÅ¾ymÄ—tas studijuojantis doktorantÅ«roje.<br>
              4. Tikrinama ar suminis kintamasis lygus atskirÅ³ dÄ—menÅ³ sumai.",
  answer(skales <- c(
    "Tinkamumo taisyklÄ—",
    "PraleistÅ³ reikÅ¡miÅ³ ir eiliÅ¡kumo taisyklÄ—",
    "LoginÄ— taisyklÄ—",
    "Suderinamumo taisyklÄ—"), correct = TRUE), correct = "Teisingai!", incorrect = "Bandykite dar kartÄ…!",
  allow_retry = TRUE,
  random_answer_order = TRUE,
  submit_button = "Pateikti",
  options = sortable_options(), 
  try_again_button = "IÅ¡ naujo"
)
```

#### 4.2. Nustatykite standartinÄ¯ `pvm` nuokrypÄ¯.

```{r SD, exercise=TRUE, exercise.lines = 2}
duomenys$pvm, na.rm=TRUE

```

```{r SD-hint}
Galite naudotis sd() funkcija. 
```

```{r SD-solution}
sd(duomenys$pvm, na.rm=TRUE)
```
```{r SD-check}
gradethis::grade_code()

```

```{r quiz5, warning=FALSE, echo=FALSE}
quiz(caption = "",
  question("KokiÄ… standartinio `pvm` nuokrypio reikÅ¡mÄ™ nustatÄ—te?", 
           answer("4981699"),
           answer("5047637", correct = TRUE),
           answer("97020.05"),
           answer("923816.5"),
           correct = "Atsakymas teisingas!", 
           incorrect = "Bandykite dar kartÄ….",
           allow_retry = TRUE,
  submit_button = "Pateikti", 
  try_again_button = "IÅ¡ naujo"
  )
)
```
## 5. IÅ¡siskirianÄios reikÅ¡mÄ—s (iÅ¡skirtys)

```{r, echo=FALSE, out.width="70%", fig.align = "center"}
knitr::include_graphics("images/outliers.jpg")  
```


DaÅ¾niausiai naudojami priimtinumo intervalai: 
$$(\mu âˆ’ğŸ\sigma, \mu +2\sigma) ir (\muâˆ’ğŸ‘\sigma, \mu+ğŸ‘\sigma )$$ 
Pirmojo intervalo taikymas daÅ¾nai vadinamas dviejÅ³ sigma, o antrasis â€“ trijÅ³ sigma taisykle. Ä® pirmÄ…jÄ¯ intervalÄ… netelpanÄios, taÄiau patenkanÄios Ä¯ antrÄ…jÄ¯ intervalÄ… reikÅ¡mÄ—s daÅ¾nai vadinamos sÄ…lyginÄ—mis iÅ¡skirtimis, o netelpanÄios ir Ä¯ platesnÄ¯jÄ¯ intervalÄ… â€“ iÅ¡skirtimis.



#### 5.1. Tarkime, mÅ«sÅ³ priimtinumo intervalas yra dviejÅ³ sigmÅ³ taisyklÄ—, o iÅ¡skirtimis laikome reikÅ¡mes besiskirianÄias 4-iomis sigmomis. PerÅ¾velkite Å¾emiau esantÄ¯ grafikÄ… ir atsakykite Ä¯ klausimÄ…:
```{r isskirtys, warning=FALSE, echo=FALSE}
quiz(caption = "",
  question("Kokiomis spalvomis paÅ¾ymÄ—tos sÄ…lyginÄ—s iÅ¡skirtys Å¾emiau pateiktame normaliojo skirstinio grafike?", 
           answer("Raudona"),
           answer("MÄ—lyna"), 
           answer("Å½alia", correct = TRUE),
           answer("OranÅ¾ine"),
           correct = "Atsakymas teisingas! SÄ…lygine iÅ¡skirtimi gali bÅ«ti tiek reikÅ¡mÄ— mÄ—lyname, tiek Å¾aliame intervaluose, priklausomai nuo to, kokÄ¯ daugybos koeficientÄ… pasirinksime. Pasirinkus dviejÅ³ sigmÅ³ taisyklÄ™ , Å¡iuo atveju, sÄ…lygine iÅ¡sksirtimi laikomos reikÅ¡mÄ—s Å¾alioje zonoje.", 
           incorrect = "Bandykite dar kartÄ….",
           allow_retry = TRUE,
  submit_button = "Pateikti", 
  try_again_button = "IÅ¡ naujo"
  )
)
```


```{r, echo=FALSE, out.width="90%", fig.align = "center"}
knitr::include_graphics("images/Standard_deviation.png")  
```
<br> 

#### 5.2. Patikrinkite ar yra iÅ¡siskirianÄiÅ³ reikÅ¡miÅ³ `duomenys` bazÄ—je, `pvm` stupelyje, naudojantis Å¾emiau pateiktu kodu, pakeiskite jÅ³ spalvÄ…. 

```{r issiskiriancios-reiksmes1, exercise=TRUE, exercise.cap = "R kodas", warning=FALSE, echo=FALSE}
duomenys %>%	
  select(pvm) %>% 	
  drop_na() %>%	
  ggplot() +	
    aes(x = log(pvm)) +	
    geom_boxplot()	
```

```{r issiskiriancios-reiksmes1-hint}
SpalvÄ… galite pakeisti Ä¯vesdami spalvos pavadinimÄ… Ä¯ geom_boxplot, pvz. geom_boxplot(outlier.color = "navyblue")	
```

```{r issiskiriancios-reiksmes1-solution}
duomenys %>%	
  select(pvm) %>% 	
  drop_na() %>%	
  ggplot() +	
    aes(x = log(pvm)) +	
    geom_boxplot(outlier.color = "navyblue")	
```
```{r issiskiriancios-reiksmes1-check}
gradethis::grade_code()

```

#### 5.3.Vizualiai patikrinkite ar yra iÅ¡siskirianÄiÅ³ reikÅ¡miÅ³ `duomenys` bazÄ—je, `viso` stupelyje. Grafinis sprendimas analogiÅ¡kas *5.2*.

```{r issiskiriancios-reiksmes2, exercise=TRUE,exercise.cap = "R kodas", warning=FALSE, echo=FALSE}

```

```{r issiskiriancios-reiksmes2-solution}
duomenys %>%	
  select(viso) %>% 	
  drop_na() %>%	
  ggplot() +	
    aes(x = log(viso)) +	
    geom_boxplot()	
```
```{r issiskiriancios-reiksmes2-check}
gradethis::grade_code()

```

#### 5.4. Patikrinkite ar yra iÅ¡siskirianÄiÅ³ reikÅ¡miÅ³ `duomenys` bazÄ—je, lyginant `pvm` bei `viso` stupelius, pakeiskite iÅ¡skirÄiÅ³ spalvÄ…. 

```{r issiskiriancios-reiksmes3, exercise=TRUE, exercise.cap = "R kodas", warning=FALSE, echo=FALSE}
duomenys %>%	
  select(pvm, viso) %>% 	
  drop_na() %>%
  ggplot() +	
    aes(x = ___, y = ___, ___ = viso & pvm > 1.1e+8) +	
    geom_point()	
```

```{r issiskiriancios-reiksmes3-hint}
X aÅ¡yje Ä¯veskite pvm, y aÅ¡yje - viso. Galiausiai, nepamirÅ¡kite pakeisti spalvos su funkcija color = .
```

```{r issiskiriancios-reiksmes3-solution}
duomenys %>%    
  select(pvm, viso) %>%     
  drop_na() %>% 
  ggplot() +    
    aes(x = pvm, y = viso, color = viso & pvm > 1.1e+8) +  
    geom_point()
```
```{r issiskiriancios-reiksmes3-check}
gradethis::grade_code()

```


```{r issiskiriancios-reiksmes4, warning=FALSE, echo=FALSE}
quiz(caption = "",
  question("Kiek iÅ¡skiÄiÅ³ pastebÄ—jote skirstinio grafike?", 
           answer("1"),
           answer("2", correct = TRUE), 
           answer("3"),
           answer("4"),
           correct = "Atsakymas teisingas!", 
           incorrect = "Bandykite dar kartÄ…. IÅ¡skirtys paÅ¾ymÄ—tos melsva spalva.",
           allow_retry = TRUE,
  submit_button = "Pateikti", 
  try_again_button = "IÅ¡ naujo"
  )
)
```

## 6. RÄ—Å¾iÅ³ taisyklÄ—

RÄ—Å¾iÅ³ taisyklÄ— taikoma, kai du ar daugiau kintamÅ³jÅ³, nesusijusiÅ³ apibrÄ—Å¾tomis formulÄ—mis, gali bÅ«ti susieti apytiksliu santykiu, pvz., jei kintamasis $X=ğ´$, tai kintamasis $ğ‘Œ$ turi bÅ«ti tarp $ğµ$ ir $ğ¶$.
<br> 

#### 6.1. ApskaiÄiuokite apatinÄ¯ ir virÅ¡utinÄ¯ rÄ—Å¾Ä¯ `viso` iÅ¡skirtims. 

```{r reziu-taisykle, exercise=TRUE, exercise.lines = 12, exercise.cap = "R kodas", warning=FALSE, echo=FALSE}
q <- quantile(___$___, probs = c(0.25,0.75), type = 2, na.rm = T)
IQR <- IQR(___$___, type = 2, na.rm = T)
apat_rez <- unname(q[1]-3*IQR)
virs_rez <- unname(q[2]+3*IQR)
cat("Tarpkvartilinis skirtumas: IQR =",IQR,"\n",
    "Priimtinumo intervalas: [",apat_rez, ";",virs_rez, "]")
isskirtys <- data.frame(duomenys, TIKRINTI = ifelse(___$___ < apat_rez | ___$___ > virs_rez, 1, 0))
View(isskirtys)
```

```{r reziu-taisykle-hint, exercise.lines = 3}
Pabrauktose vietose Ä¯veskite tikrinamÅ³ kintamÅ³jÅ³ pavadinimus, t.y `duomenys` ir `viso`.
```

```{r reziu-taisykle-solution}
q <- quantile(duomenys$viso, probs = c(0.25,0.75), type = 2, na.rm = T)
IQR <- IQR(duomenys$viso, type = 2, na.rm = T)
apat_rez <- unname(q[1]-3*IQR) 
virs_rez <- unname(q[2]+3*IQR)
cat("Tarpkvartilinis skirtumas: IQR =",IQR,"\n",
    "Priimtinumo intervalas: [",apat_rez, ";",virs_rez, "]")
isskirtys <- data.frame(duomenys, TIKRINTI = ifelse(duomenys$viso < apat_rez | duomenys$viso > virs_rez, 1, 0))
View(isskirtys)
```

```{r reziu-taisykle-check}
gradethis::grade_code()
```


```{r, echo=FALSE, out.width="60%", fig.align = "center"}
knitr::include_graphics("images/tidydata_5.jpg")  
```

## 7. IstorinÄ— (palyginimo) taisyklÄ—

```{r, echo=FALSE, out.width="80%", fig.align = "left"}
knitr::include_graphics("images/world.png")  
```

```{r istorine-taisykle-1, warning=FALSE, echo=FALSE}
quiz(caption = "",
  question(
    "Su kuo galima lyginti einamojo laikotarpio duomenis, taikant istorinÄ™ taisyklÄ™?",
answer("Numanomais duomenimis"),
answer("TolydÅ¾iaisiais duomenimis"),
answer("Praeito laikotarpio duomenimis", correct = TRUE),
allow_retry = TRUE,
           correct = "Atsakymas teisingas!", 
           incorrect = "Bandykite dar kartÄ…. MokymÅ³ skaidrÄ—se pateiktas tikslus atsakymas",
  submit_button = "Pateikti", 
  try_again_button = "IÅ¡ naujo"
  )
)
```

```{r, echo=FALSE, out.width="10%", fig.align = "right"}
knitr::include_graphics("images/learnr.png")  
```